SELECT * FROM (SELECT `l`.* FROM (SELECT * FROM (SELECT `person_id` AS `person_id`, `procedure_occurrence_id` AS `criterion_id`, CAST('procedure_occurrence' AS string) AS `criterion_table`, CAST('procedure_occurrence' AS string) AS `criterion_domain`, CAST(`procedure_date` AS timestamp) AS `start_date`, CAST(coalesce(`procedure_date`, `procedure_date`) AS timestamp) AS `end_date`, CAST(`procedure_source_value` AS string) AS `source_value`, CAST(`procedure_source_vocabulary_id` AS string) AS `source_vocabulary_id` FROM `procedure_occurrence` AS `tab` WHERE ((`procedure_source_value` IN ('99214')) AND (`procedure_source_vocabulary_id` = 4))) AS `t1`) AS `l` LEFT SEMI JOIN `jtemp` AS `r` ON ((CAST((CAST(`r`.`start_date` AS timestamp) + INTERVAL -30 days) AS timestamp) <= `l`.`start_date`) AND (`l`.`end_date` <= CAST((CAST(`r`.`end_date` AS timestamp) + INTERVAL 1 months) AS timestamp)) AND (`l`.`person_id` = `r`.`person_id`))) AS `t1`